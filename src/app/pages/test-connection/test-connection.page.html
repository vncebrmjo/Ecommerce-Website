<!-- src/app/features/connection-test/components/connection-test.component.html -->
<div class="max-w-3xl mx-auto my-8 px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <header class="mb-8 text-center">
    <h2 class="text-3xl font-semibold text-gray-900 mb-2">
      Backend Connection Test
    </h2>
    <p class="text-gray-600 text-base">
      Verify connectivity between Angular frontend and ASP.NET Core backend
    </p>
  </header>

  <!-- Test Button -->
  <div class="flex justify-center mb-8">
    <button
      type="button"
      (click)="testConnection()"
      [disabled]="isLoading()"
      aria-label="Test connection to backend"
      class="px-8 py-3 text-base font-medium text-white bg-blue-600 rounded-md
             transition-all duration-200 ease-in-out
             hover:bg-blue-700 hover:shadow-lg hover:-translate-y-0.5
             active:translate-y-0
             disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:translate-y-0
             focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2">
      {{ isLoading() ? 'Testing...' : 'Test Connection' }}
    </button>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div 
      class="flex flex-col items-center gap-4 py-8 text-gray-600"
      role="status" 
      aria-live="polite">
      <div class="w-10 h-10 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin"></div>
      <p class="text-base">Testing connection to backend...</p>
    </div>
  }

  <!-- Result Display -->
  @if (hasResult()) {
    <div 
      [class]="isSuccess() 
        ? 'bg-success-50 border border-success-200 text-success-800' 
        : 'bg-error-50 border border-error-200 text-error-800'"
      class="p-6 rounded-lg"
      role="alert"
      aria-live="assertive">
      
      <!-- Result Header -->
      <div class="flex items-center gap-3 mb-3">
        <span class="text-2xl font-bold" aria-hidden="true">
          {{ isSuccess() ? '✓' : '✗' }}
        </span>
        <h3 class="text-xl font-semibold">
          {{ isSuccess() ? 'Connected' : 'Connection Failed' }}
        </h3>
      </div>

      <!-- Result Message -->
      <p class="mb-4 text-base">{{ testResult()?.message }}</p>

      <!-- Success Data Details -->
      @if (testResult()?.data; as data) {
        <details class="mt-4 bg-white bg-opacity-50 rounded-md overflow-hidden">
          <summary class="px-4 py-3 cursor-pointer font-medium hover:bg-white hover:bg-opacity-30 select-none transition-colors">
            View Response Details
          </summary>
          <div class="px-4 py-4 space-y-3">
            <div class="grid grid-cols-[120px_1fr] gap-4">
              <dt class="font-semibold">Status:</dt>
              <dd class="text-gray-900">{{ data.status }}</dd>
            </div>
            <div class="grid grid-cols-[120px_1fr] gap-4">
              <dt class="font-semibold">Timestamp:</dt>
              <dd class="text-gray-900">{{ data.timestamp }}</dd>
            </div>
          </div>
        </details>
      }

      <!-- Error Details -->
      @if (testResult()?.error; as error) {
        <div class="mt-4 p-4 bg-white bg-opacity-5 rounded-md">
          <strong class="block mb-2 font-semibold">Error Details:</strong>
          <pre class="p-3 bg-white bg-opacity-5 rounded text-sm overflow-x-auto whitespace-pre-wrap break-words">{{ error }}</pre>
        </div>
      }
    </div>
  }
</div>